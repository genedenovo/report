#!/usr/bin/perl
#-------------------------------------------------+
#    [APM] This script was generated by amp.pl    |
#    [APM] Created time: 2016-01-13 09:03:59      |
#-------------------------------------------------+
# name: GDHR.pl
# func:
# version: 0.1

use strict;
use warnings;

use File::Basename qw/basename/;
use FindBin qw($Bin);
use lib "$Bin/lib/";
use GDHR;

my $array = [
["ID","Name","Age","Height"],
[1,"Peng",31,170],
[2,"Xing",29,175],
[3,"Yao",6,124]
];

my $outdir = "test";
my $report = GDHR->new('-outdir'=>$outdir,-pipe=>"meta Genome",-nonlazy=>1,-url=>"http://www.omicshare.com");

my $section = $report->section(id=>"introduction",-page_head=>1);

$section->menu("h1");
$section->submenu("h2");

$section->tsv2html(-file=>"/Bio/User/aipeng/project/tmp/pca/target/6.GO_enrich_heatmap/DEGs/DEGs.GO_enrich.qvalue.xls",-name=>"test",-header=>1,-max_chars=>12);
$section->matrix2html(-matrix=>$array,-name=>"family",-header=>1);
$section->img2html(-file=>"Rosa_longicuspis-Unigene.length.png",-name=>"Length of Unigene",-width=>"60%");
$section->break;


$section = $report->section(id=>"lazy_load");
$section->menu("lazy load");
$section->submenu("imgs2html");

my @files = ("../assess/all.PCA.nosampleid.png","../assess/all.PCA.png","../assess/all.pearson.png");
my @names = ("PCA plot without samples id","PCA plot with samples id","pearson heatmap");
$section->imgs2html(-files=>\@files,-names=>\@names,-name=>"samples relation analysis");


$section->submenu("imgs2html2");

my @files1 = ();
my @files2 = ();
my @desc1 = ();
my @desc2 = ();
@names = ();
my @imgs = map { basename($_) } glob ("test/circMap/*.png");

for my $i (0 .. $#imgs){
    if ($i % 2 == 1){
        push @files1 , "../circMap/$imgs[$i]";
        push @names , "circ map [$i]";
    }else{
        push @files2 , "../circMap/$imgs[$i]";
    }
}

$section->imgs2html2(-files1=>\@files1,-files2=>\@files2,-names=>\@names,-name=>"circMap");

$report->write();
$report->pack(-format=>"zip");
